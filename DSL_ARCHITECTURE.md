# DSL –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Telegram-–±–æ—Ç–∞

## üéØ –û–±–∑–æ—Ä –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

–ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –±–æ—Ç–∞ –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **DSL (Domain Specific Language)** –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è –¥–∏–∞–ª–æ–≥–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤. –í—Å—è –ª–æ–≥–∏–∫–∞ –¥–∏–∞–ª–æ–≥–æ–≤ –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π –∏ –∫–æ–º–ø–æ–∑–∏—Ü–∏–µ–π.

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ DSL —Å–∏—Å—Ç–µ–º—ã

```
DSL –°–∏—Å—Ç–µ–º–∞
‚îú‚îÄ‚îÄ üì¶ scenarios/                    # –ü–∞–∫–µ—Ç —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
‚îÇ   ‚îú‚îÄ‚îÄ üìã registry.py              # –†–µ–µ—Å—Ç—Ä —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
‚îÇ   ‚îú‚îÄ‚îÄ üîÑ loader.py                # –ó–∞–≥—Ä—É–∑—á–∏–∫ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤  
‚îÇ   ‚îú‚îÄ‚îÄ ‚ö° executor.py              # –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
‚îÇ   ‚îú‚îÄ‚îÄ ü§ñ auto_register.py         # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ üé≠ compositions.py          # –ö–æ–º–ø–æ–∑–∏—Ü–∏–∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
‚îÇ   ‚îú‚îÄ‚îÄ üë§ user/                    # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ registration.py         # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ profile.py              # –ü—Ä–æ—Ñ–∏–ª—å
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ support.py              # –ü–æ–¥–¥–µ—Ä–∂–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ üîß manager/                 # –ú–µ–Ω–µ–¥–∂–µ—Ä—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py                 # –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ broadcast.py            # –†–∞—Å—Å—ã–ª–∫–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ administration.py       # –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ üõ†Ô∏è common/                  # –û–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ       ‚îú‚îÄ‚îÄ actions.py              # –î–µ–π—Å—Ç–≤–∏—è
‚îÇ       ‚îî‚îÄ‚îÄ validators.py           # –í–∞–ª–∏–¥–∞—Ç–æ—Ä—ã
‚îú‚îÄ‚îÄ üöÄ dsl_bootstrap.py             # –°–∏—Å—Ç–µ–º–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ üñ•Ô∏è dsl_interfaces.py            # DSL –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
‚îú‚îÄ‚îÄ ü§ñ bot_dsl.py                   # –û—Å–Ω–æ–≤–Ω–æ–π DSL –±–æ—Ç
‚îî‚îÄ‚îÄ üé¨ main_dsl.py                  # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
```

## üé≠ –°–∏—Å—Ç–µ–º–∞ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
```python
from scenarios.auto_register import user_scenario, manager_scenario
from scenarios.registry import ScenarioCategory

@user_scenario(
    id="my_scenario",
    name="–ú–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π",
    category=ScenarioCategory.REGISTRATION,
    entry_points=["/start", "begin"],
    tags=["onboarding"],
    priority=10
)
def create_my_scenario():
    return DialogBuilder("my_scenario", "–ú–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π")
        .start_with("step1")
        .add_message("step1", "–ü—Ä–∏–≤–µ—Ç!", next_step="step2")
        .add_final("step2", "–ü–æ–∫–∞!")
        .build()
```

### –¢–∏–ø—ã —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- **USER** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
- **MANAGER** - –º–µ–Ω–µ–¥–∂–µ—Ä—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏  
- **SYSTEM** - —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
- **MIXED** - —Å–º–µ—à–∞–Ω–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- **REGISTRATION** - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- **AUTHENTICATION** - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- **PROFILE** - –ø—Ä–æ—Ñ–∏–ª—å
- **COMMUNICATION** - –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è
- **ADMINISTRATION** - –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ
- **SUPPORT** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- **SETTINGS** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

## üîó –ö–æ–º–ø–æ–∑–∏—Ü–∏–∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

### –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏
```python
from scenarios.compositions import CompositionBuilder

composition = (CompositionBuilder("user_onboarding", "–û–Ω–±–æ—Ä–¥–∏–Ω–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è")
    .add_scenarios(["user_registration", "profile_view", "support_faq"])
    .add_transition("user_registration", "profile_view", "registration_completed==True")
    .add_transition("profile_view", "support_faq", "show_help==True")
    .set_entry_points(["/onboarding", "full_start"])
    .build())
```

### –ü—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏
- **user_onboarding** - –ø–æ–ª–Ω—ã–π –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **manager_workflow** - —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å –º–µ–Ω–µ–¥–∂–µ—Ä–∞
- **user_support_flow** - –ø–æ—Ç–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∫–∏
- **profile_management** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–º
- **admin_dashboard** - –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å

## üìä –î–∏–∞–ª–æ–≥–æ–≤—ã–µ –∫–∞—Ä—Ç—ã

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

#### 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (`user_registration`)
```
/start ‚Üí –°–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –¥–∞–Ω–Ω—ã–µ ‚Üí [–î–ê/–ù–ï–¢]
           ‚Üì –î–ê                ‚Üì –ù–ï–¢
       –í–≤–æ–¥ –∏–º–µ–Ω–∏          –û—Ç–∫–∞–∑ (END)
           ‚Üì
    –û–ø—ã—Ç –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ
           ‚Üì
      –í–≤–æ–¥ –≤–æ–∑—Ä–∞—Å—Ç–∞
           ‚Üì
   –°–æ–≥–ª–∞—Å–∏–µ –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É
           ‚Üì
     –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
           ‚Üì
   –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
           ‚Üì
      –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ (END)
```

**–¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞:** `/start`, `start`, `registration`
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 30 –º–∏–Ω—É—Ç
**–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ:** –ü–æ–ª–Ω–æ–µ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ

#### 2. –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è (`profile_edit`)
```
–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö ‚Üí –í—ã–±–æ—Ä –ø–æ–ª—è ‚Üí –í–≤–æ–¥ –∑–Ω–∞—á–µ–Ω–∏—è ‚Üí –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ (END)
                      ‚Üì
           [–ò–º—è/–í–æ–∑—Ä–∞—Å—Ç/–û–ø—ã—Ç/–†–∞—Å—Å—ã–ª–∫–∞/–û—Ç–º–µ–Ω–∞]
```

**–¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞:** `user_edit_profile`, `profile_edit`
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 15 –º–∏–Ω—É—Ç
**–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ:** –í–æ–∑–≤—Ä–∞—Ç –∫ –≤—ã–±–æ—Ä—É –ø–æ–ª—è

#### 3. –û–±—Ä–∞—â–µ–Ω–∏–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É (`support_request`)
```
–í—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ‚Üí –í–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è ‚Üí –ö–æ–Ω—Ç–∞–∫—Ç—ã ‚Üí –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∏–∫–µ—Ç–∞ (END)
       ‚Üì               ‚Üì              ‚Üì
[–¢–µ—Ö/–û–±—É—á–µ–Ω–∏–µ/     [–û–ø–∏—Å–∞–Ω–∏–µ]    [Email/–¢–µ–ª–µ—Ñ–æ–Ω/
 –û–ø–ª–∞—Ç–∞/–î—Ä—É–≥–æ–µ]                   –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å]
```

**–¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞:** `user_support`, `support`
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 20 –º–∏–Ω—É—Ç
**–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ:** –ü–æ–≤—Ç–æ—Ä –≤–≤–æ–¥–∞ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

### –ú–µ–Ω–µ–¥–∂–µ—Ä—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

#### 1. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (`manager_auth`)
```
/manager ‚Üí –í–≤–æ–¥ –ø–∞—Ä–æ–ª—è ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ ‚Üí [–£–°–ü–ï–•/–û–®–ò–ë–ö–ê]
                           ‚Üì           ‚Üì
                    –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è  –ü–æ–≤—Ç–æ—Ä/–û—Ç–º–µ–Ω–∞
```

**–¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞:** `/manager`, `manager`, `auth`
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 5 –º–∏–Ω—É—Ç
**–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ:** –ü–æ–≤—Ç–æ—Ä –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è

#### 2. –°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞—Å—Å—ã–ª–∫–∏ (`broadcast_creation`)
```
–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ ‚Üí –í–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è ‚Üí –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä ‚Üí [–û–¢–ü–†–ê–í–ò–¢–¨/–ò–ó–ú–ï–ù–ò–¢–¨]
                                                         ‚Üì
                                                   –û—Ç–ø—Ä–∞–≤–∫–∞ ‚Üí –†–µ–∑—É–ª—å—Ç–∞—Ç (END)
```

**–¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞:** `mgr_broadcast`, `broadcast`
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 30 –º–∏–Ω—É—Ç
**–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ:** –í–æ–∑–≤—Ä–∞—Ç –∫ –ª—é–±–æ–º—É —à–∞–≥—É

#### 3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–æ–π (`system_management`)
```
–°–∏—Å—Ç–µ–º–Ω–æ–µ –º–µ–Ω—é ‚Üí [–û—á–∏—Å—Ç–∫–∞ –ë–î/–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞/–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è/–õ–æ–≥–∏]
     ‚Üì
–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ ‚Üí –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ ‚Üí –†–µ–∑—É–ª—å—Ç–∞—Ç (END)
```

**–¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞:** —Å–∏—Å—Ç–µ–º–Ω—ã–µ callback'–∏
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 5 –º–∏–Ω—É—Ç
**–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ:** –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## üîÑ –ú–µ—Ö–∞–Ω–∏–∑–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

### –£—Ä–æ–≤–Ω–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
1. **–®–∞–≥** - –ø–æ–≤—Ç–æ—Ä —Ç–µ–∫—É—â–µ–≥–æ —à–∞–≥–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
2. **–°—Ü–µ–Ω–∞—Ä–∏–π** - –≤–æ–∑–≤—Ä–∞—Ç –∫ –Ω–∞—á–∞–ª—É —Å—Ü–µ–Ω–∞—Ä–∏—è –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–Ω–æ–π –æ—à–∏–±–∫–µ
3. **–°–µ—Å—Å–∏—è** - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–µ—Ä–≤–∞–Ω–Ω–æ–π —Å–µ—Å—Å–∏–∏ –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. **–°–∏—Å—Ç–µ–º–∞** - –≥–ª–æ–±–∞–ª—å–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ —Å–±–æ—è—Ö

### –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ** - –¥–ª—è –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ** - –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- **–§–æ–Ω–æ–≤–æ–µ** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- **–†—É—á–Ω–æ–µ** - –∫–æ–º–∞–Ω–¥—ã –æ—Ç–ª–∞–¥–∫–∏ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

## üóÉÔ∏è –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è

### –¢–∞–±–ª–∏—Ü–∞ dialog_sessions
```sql
CREATE TABLE dialog_sessions (
    user_id INTEGER,           -- ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram
    chat_id INTEGER,           -- ID —á–∞—Ç–∞
    chain_id TEXT,             -- ID —Å—Ü–µ–Ω–∞—Ä–∏—è
    current_step TEXT,         -- –¢–µ–∫—É—â–∏–π —à–∞–≥
    data TEXT,                 -- JSON —Å –¥–∞–Ω–Ω—ã–º–∏ –¥–∏–∞–ª–æ–≥–∞
    state TEXT,                -- –°–æ—Å—Ç–æ—è–Ω–∏–µ (started/in_progress/waiting_input/etc)
    created_at REAL,           -- –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è
    updated_at REAL,           -- –í—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
    retry_count INTEGER,       -- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫
    error_history TEXT,        -- JSON —Å –∏—Å—Ç–æ—Ä–∏–µ–π –æ—à–∏–±–æ–∫
    PRIMARY KEY (user_id, chat_id)
);
```

### –°–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Å—Å–∏–π
- `STARTED` - —Å—Ü–µ–Ω–∞—Ä–∏–π –Ω–∞—á–∞—Ç
- `IN_PROGRESS` - –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
- `WAITING_INPUT` - –æ–∂–∏–¥–∞–µ—Ç –≤–≤–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `COMPLETED` - —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω
- `CANCELLED` - –æ—Ç–º–µ–Ω–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
- `ERROR` - –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞
- `PAUSED` - –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

## üéÆ –ö–æ–º–∞–Ω–¥—ã –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã
- `/start` - –∑–∞–ø—É—Å–∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- `/menu` - –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é (DSL –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
- `/profile` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–º
- `/support` - –æ–±—Ä–∞—â–µ–Ω–∏–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É
- `/help` - —Å–ø—Ä–∞–≤–∫–∞ –ø–æ DSL —Å–∏—Å—Ç–µ–º–µ

### –ú–µ–Ω–µ–¥–∂–µ—Ä—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã
- `/manager` - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- `/dashboard` - –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å
- `/scenario_info` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º —Å—Ü–µ–Ω–∞—Ä–∏–∏
- `/scenario_list` - —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- `/scenario_stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- `/scenario_reload` - –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- `/scenario_cancel` - –æ—Ç–º–µ–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è

### –ö–æ–º–ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
- `/onboarding` - –ø–æ–ª–Ω—ã–π –æ–Ω–±–æ—Ä–¥–∏–Ω–≥
- `/admin_flow` - –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –ø–æ—Ç–æ–∫
- `/support_flow` - –ø–æ—Ç–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∫–∏

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –∑–∞–ø—É—Å–∫

### –§–∞–π–ª—ã –∑–∞–ø—É—Å–∫–∞
- **`main_dsl.py`** - –æ—Å–Ω–æ–≤–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏
- **`bot_dsl.py`** - DSL –±–æ—Ç
- **`dsl_bootstrap.py`** - —Å–∏—Å—Ç–µ–º–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

### –ó–∞–ø—É—Å–∫
```bash
# –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫
python main_dsl.py

# –ò–ª–∏ —á–µ—Ä–µ–∑ bootstrap
python -c "from dsl_bootstrap import quick_launch; import asyncio; asyncio.run(quick_launch())"

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é
python bot_dsl.py
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)
```env
# –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
BOT_TOKEN=your_token_here
DATABASE_PATH=english_club.db

# DSL –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
DSL_SCENARIOS_DIR=scenarios
DSL_AUTO_RELOAD=True
DSL_VALIDATION_STRICT=False

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
LOG_LEVEL=INFO
LOG_FILE=bot.log
```

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞

### –ö–æ–º–∞–Ω–¥—ã –æ—Ç–ª–∞–¥–∫–∏
```bash
# –í –±–æ—Ç–µ
/scenario_info     # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º —Å—Ü–µ–Ω–∞—Ä–∏–∏
/scenario_list     # –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤  
/scenario_stats    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
/scenario_cancel   # –û—Ç–º–µ–Ω–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è
/scenario_reload   # –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```python
import logging
logger = logging.getLogger(__name__)

# –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
# - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
# - –ó–∞–ø—É—Å–∫ –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
# - –û—à–∏–±–∫–∏ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
# - –ü–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É —à–∞–≥–∞–º–∏
# - –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
```

### –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ü–µ–Ω–∞—Ä–∏—è–º
- –ü—Ä–æ—Ü–µ–Ω—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –¥–∏–∞–ª–æ–≥–æ–≤
- –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫ –∏ —É–∑–∫–∏—Ö –º–µ—Å—Ç
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- –ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø—É—Ç–µ–π

## üöÄ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- **–î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ—Å—Ç—å** - –¥–∏–∞–ª–æ–≥–∏ –æ–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ
- **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ** - –æ–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã
- **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** - –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- **–û—Ç–ª–∞–¥–∫–∞** - –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ—à–∏–±–æ–∫
- **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–π UX –≤–æ –≤—Å–µ—Ö –¥–∏–∞–ª–æ–≥–∞—Ö
- **–°–∫–æ—Ä–æ—Å—Ç—å** - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã
- **–ì–∏–±–∫–æ—Å—Ç—å** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø—Ä–µ–¥—ã–¥—É—â–∏–º —à–∞–≥–∞–º

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
- **–ö–æ–Ω—Ç—Ä–æ–ª—å** - –ø–æ–ª–Ω–∞—è –≤–∏–¥–∏–º–æ—Å—Ç—å –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏ –≤ runtime
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ –∏ –∞—É–¥–∏—Ç –¥–µ–π—Å—Ç–≤–∏–π

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏

### –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- –°—Ç–∞—Ä—ã–π `bot.py` –æ—Å—Ç–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º
- ConversationHandler —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å DSL
- –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –±–µ–∑ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–µ—Ä–≤–∏—Å–∞
- –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

### –≠—Ç–∞–ø—ã –º–∏–≥—Ä–∞—Ü–∏–∏
1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ DSL** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤
2. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞** - DSL –∏ —Å—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞—é—Ç –≤–º–µ—Å—Ç–µ
3. **–ü–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π –ø–µ—Ä–µ–Ω–æ—Å** - –æ–¥–∏–Ω —Å—Ü–µ–Ω–∞—Ä–∏–π –∑–∞ —Ä–∞–∑
4. **–ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥** - –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–π —Å–∏—Å—Ç–µ–º—ã
5. **–û—á–∏—Å—Ç–∫–∞** - —É–¥–∞–ª–µ–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–µ–≥–æ –∫–æ–¥–∞

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–∏—Ä–∞–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—É—Å–∫–æ–≤ –∫–∞–∂–¥–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- –¢–æ—á–∫–∏ –≤—ã—Ö–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ß–∞—Å—Ç–æ—Ç–∞ –æ—à–∏–±–æ–∫ –ø–æ —à–∞–≥–∞–º
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –æ—Ç—á–µ—Ç—ã
- –ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- –ö–æ–Ω–≤–µ—Ä—Å–∏—è –ø–æ —à–∞–≥–∞–º –¥–∏–∞–ª–æ–≥–æ–≤
- –ê–Ω–∞–ª–∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã
- –û—à–∏–±–∫–∏ –∏ –∏—Ö –ø—Ä–∏—á–∏–Ω—ã

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å

### –ú–µ—Ö–∞–Ω–∏–∑–º—ã –∑–∞—â–∏—Ç—ã
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ
- **–ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞** –ø–æ —Ç–∏–ø–∞–º —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- **–¢–∞–π–º–∞—É—Ç—ã** –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∑–∞–≤–∏—Å—à–∏—Ö —Å–µ—Å—Å–∏–π
- **–ê—É–¥–∏—Ç** –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
- **–ò–∑–æ–ª—è—Ü–∏—è** —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- **Graceful degradation** - —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ** - –ø–æ–ø—ã—Ç–∫–∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö** - –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –ø–æ–ª—É—á–∞—é—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö
- **–û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–º–µ–Ω–∏—Ç—å –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

## üéØ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è
```python
@user_scenario(id="greeting", name="–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ")
def create_greeting():
    return (DialogBuilder("greeting", "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ")
        .start_with("hello")
        .add_message("hello", "–ü—Ä–∏–≤–µ—Ç!", next_step="ask_name")
        .add_question("ask_name", "–ö–∞–∫ –∑–æ–≤—É—Ç?", next_step="bye")
        .add_final("bye", "–ü–æ–∫–∞, {ask_name}!")
        .build())
```

### –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏—è —Å –≤—ã–±–æ—Ä–æ–º
```python
@user_scenario(id="survey", name="–û–ø—Ä–æ—Å")
def create_survey():
    return (DialogBuilder("survey", "–û–ø—Ä–æ—Å")
        .start_with("question")
        .add_choice("question", "–ù—Ä–∞–≤–∏—Ç—Å—è –±–æ—Ç?", 
                   inline_keyboard=[
                       [("üëç –î–∞", "yes")], 
                       [("üëé –ù–µ—Ç", "no")]
                   ])
        .add_condition("question", {
            "question=='yes'": "thanks",
            "question=='no'": "sorry"
        })
        .add_final("thanks", "–°–ø–∞—Å–∏–±–æ! üòä")
        .add_final("sorry", "–ë—É–¥–µ–º —É–ª—É—á—à–∞—Ç—å! üîß")
        .build())
```

### –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏
```python
def create_full_user_experience():
    return (CompositionBuilder("full_experience", "–ü–æ–ª–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç")
        .add_scenarios(["greeting", "survey", "registration"])
        .add_transition("greeting", "survey", "always")
        .add_transition("survey", "registration", "wants_to_register==True")
        .build())
```

## üöÄ –ó–∞–ø—É—Å–∫ –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫
```bash
# 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env

# 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# 3. –ó–∞–ø—É—Å–∫ DSL –±–æ—Ç–∞
python main_dsl.py
```

### –ü—Ä–æ–¥–∞–∫—à–Ω —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã
python main_dsl.py --check

# 2. –ó–∞–ø—É—Å–∫ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º
python main_dsl.py --monitor

# 3. –ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–µ
nohup python main_dsl.py > bot.log 2>&1 &
```

## üîÆ –ë—É–¥—É—â–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ

### –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- **A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–∏–∞–ª–æ–≥–æ–≤
- **–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ** –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- **API** –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
- **–í–∏–∑—É–∞–ª—å–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä** —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- **–®–∞–±–ª–æ–Ω—ã —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤** –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è

### –†–∞—Å—à–∏—Ä–µ–Ω–∏—è
- **–ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–æ–≤
- **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è** - –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏** - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞** - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∏ –æ—Ç—á–µ—Ç—ã

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –æ–±—É—á–µ–Ω–∏–µ

### –î–æ–∫—É–º–µ–Ω—Ç—ã
- `DSL_ARCHITECTURE.md` - —ç—Ç–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `DIALOG_ARCHITECTURE.md` - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–∏–∞–ª–æ–≥–æ–≤
- `README.md` - –æ–±—â–µ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `examples/` - –ø—Ä–∏–º–µ—Ä—ã —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∏ –∫–æ–º–ø–æ–∑–∏—Ü–∏–π

### –û–±—É—á–∞—é—â–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
- –ü—Ä–∏–º–µ—Ä—ã –≤ `scenarios/compositions_demo.py`
- –®–∞–±–ª–æ–Ω—ã –≤ `examples/dialog_examples.py`
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- –õ–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è

---

**DSL –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –≥–∏–±–∫–æ—Å—Ç—å, –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã –¥–∏–∞–ª–æ–≥–æ–≤! üéâ**